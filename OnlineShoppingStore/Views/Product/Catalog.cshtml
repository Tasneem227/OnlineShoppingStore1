@model List<Product>
<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<title>Aurum - Bootstrap 4 Ecommerce Template</title>
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
	<link rel="shortcut icon" href="/images/favicon.ico">
	<link rel="stylesheet" href="/bootstrap/css/bootstrap.css">
	<link rel="stylesheet" href="/css/bootstrap-slider.min.css">

	<script defer src="https://use.fontawesome.com/releases/v5.0.6/js/all.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.11.0/umd/popper.min.js"></script>
	<script src="js/bootstrap-slider.min.js"></script>
	<link rel="stylesheet" href="css/style.css">

	<style>
		.product-item img {
			width: 100%;
			height: 250px;
			object-fit: cover;
			border-radius: 8px;
		}
	</style>
</head>
<body>

	<div class="container">
		<div class="row">
			<!-- خليت المنتجات تاخد الصفحة كلها -->
			<div class="col-12">
				<section class="products">
					<div class="container">

						<div class="row" id="productsContainer">
							@for (int i = 0; i < Model.Count; i++)
							{
								<div class="col-md-3 col-lg-3 col-sm-6 col-12 col-product product-item @(i >= 16 ? "d-none" : "")">
									<figure>
										<img class="img-fluid" src="~/images/Products/@Model[i].ImageUrl">
										<figcaption>
											<div class="thumb-overlay">
												<button class="btn btn-outline-success"
														onclick="addToCart(@Model[i].ProductId, this)">
													Add To Cart
												</button>
											</div>
										</figcaption>
									</figure>

									<h4 class="mb-1">
										<a asp-action="Details" asp-controller="Product" asp-route-ProductId="@Model[i].ProductId">@Model[i].Name</a>
									</h4>
									<p><span class="emphasis">@Model[i].Price</span></p>
								</div>
							}
						</div>

						<!-- زرار المزيد -->
						<div class="text-center mt-4">
							<button id="loadMoreBtn" class="btn btn-lg btn-primary">
								More <i class="fas fa-plus ml-2"></i>
							</button>
						</div>

					</div>
				</section>
			</div>
		</div>
	</div>

	<div class="divider"></div>

	<section class="cta text-center">
		<div class="container">
			<h3 class="mt-0 mb-4">Sign up now to save 10% on your first order</h3>
			<form class="subscribe">
				<div class="form-group row pt-3">
					<div class="col-sm-8 mb-3">
						<input type="text" class="form-control" id="inputName" placeholder="Your Name">
					</div>
					<div class="col-sm-4">
						<button type="submit" class="btn btn-lg btn-outline-primary">Sign me up</button>
					</div>
				</div>
			</form>
		</div>
	</section>

	<!-- Scripts -->
	<script src="/js/jquery-3.1.1.min.js"></script>
	<script src="/bootstrap/js/bootstrap.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/tether/1.4.0/js/tether.min.js"></script>

	<script>
		function addToCart(productId, btn) {
			fetch(`/Cart/AddToCart?productId=${productId}&Quantity=1`, {
				method: "POST"
			})
			.then(response => {
				if (response.ok) {
					btn.innerText = "Added Successfully ✅";
					setTimeout(() => {
						btn.innerText = "Add To Cart";
					}, 2000);
				} else {
					btn.innerText = "Error ❌";
				}
			});
		}

		// Load More Logic
		let itemsToShow = 16;
		let currentCount = 16;

		document.getElementById("loadMoreBtn").addEventListener("click", function () {
			let btn = this;
			btn.innerHTML = "Loading...";

			setTimeout(() => {
				let products = document.querySelectorAll(".product-item.d-none");

				for (let i = 0; i < itemsToShow && i < products.length; i++) {
					products[i].classList.remove("d-none");
					currentCount++;
				}

				if (document.querySelectorAll(".product-item.d-none").length === 0) {
					btn.style.display = "none";
				} else {
					btn.innerHTML = 'More <i class="fas fa-plus ml-2"></i>';
				}
			}, 500);
		});
	</script>

</body>
</html>
